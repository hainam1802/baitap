(function($) {
    $.fn.onTextEnter = function(options) {
        var defaults = {
            btnToTrigger: null
        };
        var opts = $.extend(defaults, options);
        return this.each(function() {
            var self = $(this);
            self.bind('keypress', function(evt) {
                if (evt.which && evt.which == 13) {
                    if (opts.btnToTrigger != null) opts.btnToTrigger.trigger('click');
                    return !1
                } else return !0
            })
        })
    }, $.fn.clickOff = function(callback, selfDestroy) {
        var clicked = !1;
        var parent = this;
        var destroy = selfDestroy || !0;
        parent.click(function() {
            clicked = !0
        });
        $(document).click(function(event) {
            if (!clicked) {
                callback(parent, event)
            }
            if (destroy) {};
            clicked = !1
        })
    }
})(jQuery);
var Common = function() {
    var siteName = '';
    var siteLanguage = 'vi';
    var isRTL = !1;
    var isIE8 = !1;
    var isIE9 = !1;
    var isIE10 = !1;
    var isIE11 = !1;
    var responsiveHandlers = [];
    _arraystart = [];
    var directionsDisplay;
    var directionsService;
    var handleInit = function() {
        isIE8 = !!navigator.userAgent.match(/MSIE 8.0/);
        isIE9 = !!navigator.userAgent.match(/MSIE 9.0/);
        isIE10 = !!navigator.userAgent.match(/MSIE 10.0/);
        isIE11 = !!navigator.userAgent.match(/MSIE 11.0/);
        if (isIE10)
            $('html').addClass('ie10');
        if (isIE11)
            $('html').addClass('ie11');
        if (screen.width > 768) {
            var registerForm = $("#registerForm");
            var loginForm = $("#loginForm");
            if (registerForm)
                registerForm.find("input").removeAttr('placeholder');
            if (loginForm)
                loginForm.find("input").removeAttr('placeholder')
        }
        if ($('body').length > 0 && $('body').data('page') != undefined)
            siteName = $('html').data('page');
        if ($('html').length > 0 && $('html').attr('lang') != undefined)
            siteLanguage = $('html').attr('lang');
        $('[data-toggle="tooltip"]').tooltip();
        $("#ivivuModal").modal({
            show: !1
        }).on('hidden.bs.modal', function(e) {
            $(this).find('.modal-header, .modal-body, .modal-footer').html('');
            $(this).find('.modal-dialog').attr('class', 'modal-dialog');
            $(this).find('.modal-header').attr('class', 'modal-header');
            $(this).find('.modal-body').attr('class', 'modal-body');
            $(this).find('.modal-footer').attr('class', 'modal-footer');
            $(this).find('.modal-header, .modal-footer').addClass('hide');
            if (Payrequest != undefined)
                Payrequest.destroy();
            if ($('#modalmap').length > 0 && $('#modalmap').gmap3('get'))
                $('#modalmap').gmap3('destroy')
        })
    };
    var runResponsiveHandlers = function() {
        for (var i in responsiveHandlers) {
            var each = responsiveHandlers[i];
            each.call()
        }
    };
    var handleResponsiveOnResize = function() {
        var resize;
        if (isIE8) {
            var currheight;
            $(window).resize(function() {
                if (currheight == document.documentElement.clientHeight) {
                    return
                }
                if (resize) {
                    clearTimeout(resize)
                }
                resize = setTimeout(function() {
                    runResponsiveHandlers()
                }, 50);
                currheight = document.documentElement.clientHeight
            })
        } else {
            $(window).resize(function() {
                if (resize) {
                    clearTimeout(resize)
                }
                resize = setTimeout(function() {
                    runResponsiveHandlers()
                }, 50)
            })
        }
    };
    var handleIEFixes = function() {
        if (isIE8 || isIE9) {
            $('input[placeholder]:not(.placeholder-no-fix), textarea[placeholder]:not(.placeholder-no-fix)').each(function() {
                var input = $(this);
                if (input.val() == '' && input.attr("placeholder") != '') {
                    input.addClass("placeholder").val(input.attr('placeholder'))
                }
                input.focus(function() {
                    if (input.val() == input.attr('placeholder')) {
                        input.val('')
                    }
                });
                input.blur(function() {
                    if (input.val() == '' || input.val() == input.attr('placeholder')) {
                        input.val(input.attr('placeholder'))
                    }
                })
            })
        }
    };
    var mappingK = {
        'nhatrang': 'nha trang',
        'phanthiet': 'phan thiet',
        'phuquoc': 'phu quoc',
        'vungtau': 'vung tau',
        'dalat': 'da lat',
        'hoian': 'hoi an',
        'danang': 'da nang',
        'sa pa': 'sapa',
        'nhatrang': 'nha trang',
        'phuquoc': 'phu quoc',
        'vinhhalong': 'vinh ha long',
        'halongbay': 'vinh ha long',
        'hanoi': 'ha noi',
        'saigon': 'ho chi minh',
        'sai gon': 'ho chi minh',
        'sÃ i gÃ²n': 'Há»“ ChÃ­ minh',
        'hochiminh': 'ho chi minh',
        'bang coc': 'bangkok',
        'bÄƒng cá»‘c': 'bangkok',
        'xinh ga po': 'singapore',
        'sinh ga po': 'singapore',
        'xinhgapo': 'singapore',
        'sinhgapo': 'singapore',
        'xingapo': 'singapore',
        'singapo': 'singapore'
    }
    var handleMobiToggler = function() {
        $(".mobi-toggler").on("click", function(event) {
            event.preventDefault();
            $("header").toggleClass("menuOpened");
            $("header").find(".header-navigation").toggle()
        })
    };
    var KeywordEnter = function(input) {
        var homepagelink = $("#linkStore").val();
        if (homepagelink != null && homepagelink != undefined && homepagelink != "") {
            window.location.href = homepagelink
        } else {
            var keyword = input.val().toLowerCase();
            if (mappingK[keyword]) keyword = mappingK[keyword];
            input.val(keyword);
            var URL = '/request/searchautocomplete';
            $.getJSON(URL, {
                keyword: keyword
            }, function(data) {
                var flag = !1;
                $.each(data, function(index, d) {
                    if (d.Type == "region" && d.More != 0) {
                        flag = !0;
                        window.location.href = d.Path
                    }
                });
                if (!flag) $("#homepage-search-form,#header-search-form").submit()
            })
        }
    }
    var EnterBeforeAutoComplete = function() {
        $('#search-header-text').keypress(function(event) {
            if (event.keyCode === 13) {
                KeywordEnter($('#search-header-text'));
                return !1
            }
        });
        $('#search-home-text').keypress(function(event) {
            if (event.keyCode === 13) {
                KeywordEnter($('#search-home-text'));
                return !1
            } else {
                $("#linkStore").val("")
            }
        })
    }
    var loadAutoComplete = function(searchTextField) {
        var keyword = searchTextField.val();
        var searchElement = searchTextField.siblings(".search-autocomplete");
        if (keyword.trim().length < 3 || keyword.trim() == '') {
            searchElement.find(".autocomplete-wrap").html('');
            searchElement.hide();
            return
        }
        var URL = '/request/searchautocomplete';
        $.getJSON(URL, {
            keyword: keyword
        }, function(data) {
            if (data.length == 0) {
                searchElement.find(".autocomplete-wrap").html('');
                searchElement.hide();
                return
            }
            var result = '';
            var flagRegion = flagHappyDeal = flagHotel = flagTour = !1;
            $.each(data, function(index, d) {
                if (d.Type == 'region' && flagRegion == !1) {
                    result += '<div class="title">Äá»‹a Ä‘iá»ƒm</div>';
                    flagRegion = !0
                }
                if (d.Type == 'hotel' && flagHotel == !1) {
                    result += '<div class="title">KhÃ¡ch sáº¡n</div>';
                    flagHotel = !0
                }
                if (d.Title != '') {
                    if (d.Type == 'region') {
                        result += '<div class="item-place"><a href="' + d.Path;
                        if (d.More == null || d.More == undefined)
                            result += '">' + d.Title + '</a></div>';
                        else result += '">' + d.Title + '</a> ';
                        if (d.More != '' && d.More != undefined && d.More != 0)
                            result += '<span><b>' + d.More + '</b>ks</span>';
                        result += '</div>'
                    } else result += '<div class="item"><a href="' + d.Path + '">' + d.Title + '</a></div>'
                }
            });
            searchElement.find(".autocomplete-wrap").html(result);
            searchElement.show();
            $('.autocomplete-wrap a').click(function() {
                var b = $(this).html();
                if (b != null && b != undefined && b != "") {
                    $("#search-home-text,#search-header-text").val(b);
                    var link = $(this).attr('href');
                    if (link != null && link != undefined && link != "") {
                        $("#linkStore").val(link);
                        $('#homepage-search-button').focus();
                        $('#header-search-button').focus()
                    }
                }
                $('#homepage-search-autocomplete').hide();
                $('#header-search-autocomplete').hide();
                return !1
            })
        })
    };
    var handleAutoComplete = function() {
        $('#search-home-text, #search-menu-text,#search-header-text').focusin(function() {
            if (($(this).val() != '') && ($(this).siblings(".search-autocomplete").find('.autocomplete-wrap').html().trim() != ''))
                $(this).siblings(".search-autocomplete").show()
        }).focusout(function() {
            if (!$(this).siblings(".search-autocomplete").is(':hover'))
                $(this).siblings(".search-autocomplete").hide()
        }).on('keyup input propertychange', function() {
            var selector = $(this);
            clearTimeout($.data(this, 'timer'));
            var wait = setTimeout(function() {
                loadAutoComplete(selector)
            }, 500);
            $(this).data('timer', wait)
        })
    };
    var handlePriceRequest = function() {
        if ($(".call-pricerequest").length > 0) {
            $(".call-pricerequest").off('click');
            $(".call-pricerequest").on('click', function() {
                var header = "";
                var body = "";
                var footer = "";
                var hotelId = $(this).data("hotelid");
                if ($("#PRG .head").length > 0)
                    header = $("#PRG .head").html();
                if ($("#PRG .body").length > 0)
                    body = $("#PRG .body").html();
                if ($("#PRG .foot").length > 0)
                    footer = $("#PRG .foot").html();
                Static.htmlModal(header, body, footer);
                if ($("#ivivuModal").find("input[name=datepicker-modal-chkin]").length > 0)
                    $("#ivivuModal").find("input[name=datepicker-modal-chkin]").attr('id', 'datepicker-modal-chkin').addClass('datepicker-chkin');
                if ($("#ivivuModal").find("input[name=datepicker-modal-chkout]").length > 0)
                    $("#ivivuModal").find("input[name=datepicker-modal-chkout]").attr('id', 'datepicker-modal-chkout').addClass('datepicker-chkout');
                if ($("#ivivuModal").find("input[name=datepicker-modal-nights]").length > 0)
                    $("#ivivuModal").find("input[name=datepicker-modal-nights]").attr('id', 'datepicker-modal-nights').addClass('datepicker-nights');
                Static.shownModal(function() {
                    if (Payrequest != undefined)
                        Payrequest.init()
                });
                Static.loadHotelPrg(hotelId);
                return !1
            })
        }
        if ($(".call-messagedata").length > 0) {
            $(".call-messagedata").click(function() {
                var data = $(this).data("message");
                if (data.length > 0)
                    Static.showMessageBox(data)
            })
        }
    };
    var calcRoute = function(lat, log, _name, marker) {
        var start = new google.maps.LatLng(_arraystart[0].lat, _arraystart[0].lng);
        var end = new google.maps.LatLng(lat, log);
        var request = {
            origin: start,
            destination: end,
            travelMode: google.maps.DirectionsTravelMode.DRIVING
        };
        var directionsService = new google.maps.DirectionsService();
        directionsService.route(request, function(response, status) {
            if (status == google.maps.DirectionsStatus.OK) {
                var _hh = response.routes[0].legs[0].duration.text;
                var _km = Number(getDistance(_arraystart[0].lat, _arraystart[0].lng, Number(response.request.destination.H), Number(response.request.destination.L)) / 1000);
                var request = {
                    origin: start,
                    destination: end,
                    travelMode: google.maps.DirectionsTravelMode.WALKING
                };
                directionsService.route(request, function(response, status) {
                    if (status == google.maps.DirectionsStatus.OK) {
                        var _dibo = response.routes[0].legs[0].duration.text;
                        var _html = "";
                        _html += "<div style='width:200px;float:left'>";
                        _html += "<div style='width:100%;float:left'>" + _name + "</div>";
                        _html += "<div style='clear:left'></div>";
                        _html += "<div style='width:33.33%;float:left'>" + Math.round(Number(_km) * 10) / 10 + " km </div>";
                        _html += "<div style='width:33.33%;float:left'><i class='icon-cars'></i>" + _hh + "</div>";
                        _html += "<div style='width:33.33%;float:left'><i class='icon-walk'></i>" + _dibo + "</div>";
                        _html += "</div>";
                        var map = $("#modalmap").gmap3("get");
                        var infowindow = $("#modalmap").gmap3({
                            get: {
                                name: "infowindow"
                            }
                        });
                        if (infowindow) {
                            infowindow.setContent(_html);
                            infowindow.open(map, marker)
                        } else {
                            $("#modalmap").gmap3({
                                infowindow: {
                                    anchor: marker,
                                    options: {
                                        content: _html
                                    }
                                }
                            })
                        }
                    }
                })
            }
        })
    };
    var getDistance = function(lat1, lng1, lat2, lng2) {
        var lat = [lat1, lat2]
        var lng = [lng1, lng2]
        var R = 6378137;
        var dLat = (lat[1] - lat[0]) * Math.PI / 180;
        var dLng = (lng[1] - lng[0]) * Math.PI / 180;
        var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(lat[0] * Math.PI / 180) * Math.cos(lat[1] * Math.PI / 180) * Math.sin(dLng / 2) * Math.sin(dLng / 2);
        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        var d = R * c;
        return Math.round(d)
    };
    var addMarker = function(Latitude, Longitude, _name) {
        $('#modalmap').gmap3({
            marker: {
                latLng: [Latitude, Longitude],
                data: _name,
                options: {
                    icon: new google.maps.MarkerImage("//maps.gstatic.com/mapfiles/icon_green.png"),
                },
                events: {
                    click: function(marker, event, context) {
                        calcRoute(Latitude, Longitude, _name, marker)
                    }
                }
            }
        })
    };
    var _setmap = function() {
        var _data = $("#listlatlong").val();
        var _split = _data.split("hung");
        var i = 0;
        for (; i < _split.length - 1; i++) {
            var _datttt = _split[i];
            var _a = _datttt.split('@');
            addMarker(_a[0], _a[1], _a[2])
        }
    };
    var handleMap = function() {
        if ($(".call-modal-map").length > 0) {
            $(".call-modal-map").click(function() {
                var lat = $(this).data("lat");
                var lng = $(this).data("lng");
                var _data = $("#listlatlong").val();
                var sing = {};
                sing.lat = lat;
                sing.lng = lng;
                _arraystart.push(sing);
                var header = "";
                var body = "";
                var footer = "";
                if ($("#MMP .head").length > 0) {
                    header = $("#MMP .head").html()
                }
                if ($("#MMP .body").length > 0) {
                    body = $("#MMP .body").html()
                }
                if ($("#MMP .foot").length > 0) {
                    footer = $("#MMP .foot").html()
                }
                $('#ivivuModal .modal-dialog').addClass("modal-lg");
                Static.htmlModal(header, body, footer);
                Static.styleModal("", "", "nopadding");
                Static.shownModal(function() {
                    var width = $('#ivivuModal .modal-body').width() - 3;
                    $('#modalmap').width(width + "px").height("420px").gmap3({
                        map: {
                            options: {
                                center: [lat, lng],
                                zoom: 15,
                                mapTypeControl: !0,
                                navigationControl: !0,
                                scrollwheel: !0
                            }
                        },
                        marker: {
                            options: {
                                icon: '//res.ivivu.com/hotel/img/marker.png'
                            },
                            latLng: [lat, lng]
                        }
                    });
                    _setmap()
                })
            })
        }
    };
    var _openlogin = function() {
        $('#login-modal').modal({
            show: 'true',
            keyboard: !0
        })
    };
    var _enterlogin = function() {
        $("#show_loading").show();
        var _username = $("#namelogin").val();
        var _password = $("#password").val();
        var _k = 0;
        if (_username == "") {
            _showerror("Vui lÃ²ng nháº­p tÃªn Ä‘Äƒng nháº­p !", "namelogin");
            $("#show_loading").hide();
            _k = 1
        }
        if (_password == "") {
            _showerror("Vui lÃ²ng nháº­p máº­t kháº©u !", "password");
            $("#show_loading").hide();
            _k = 1
        }
        if (_k != 0) {
            return
        } else {
            $("#show_loading").hide();
            $.ajax({
                url: Static.rootpay() + "/kiem-tra-dang-nhap",
                type: 'GET',
                data: {
                    username: _username,
                    password: _password
                },
                crossDomain: !0,
                dataType: 'jsonp',
                jsonp: !1
            })
        }
    };
    var _checklogin = function() {
        var _pareameter = window.location.hash.substring(1);
        if (_pareameter != "") {
            if (_pareameter.length > 0) {
                if (_pareameter != "review") {
                    if (_pareameter.length > 0) {
                        $.ajax({
                            url: Static.rootpay() + "/kiem-tra-dang-nhap-a",
                            data: {
                                key: _pareameter
                            },
                            type: 'GET',
                            crossDomain: !0,
                            dataType: 'jsonp',
                            jsonp: !1
                        })
                    }
                }
            }
        }
    };
    var _login = function() {
        $("#btnlogin").click(function() {
            $("#show_loading").show();
            var _username = $("#namelogin").val();
            var _password = $("#password").val();
            var _k = 0;
            if (_username == "") {
                _showerror("Vui lÃ²ng nháº­p tÃªn Ä‘Äƒng nháº­p !", "namelogin");
                $("#show_loading").hide();
                _k = 1
            }
            if (_password == "") {
                _showerror("Vui lÃ²ng nháº­p máº­t kháº©u !", "password");
                $("#show_loading").hide();
                _k = 1
            }
            if (_k != 0) {
                return
            } else {
                $("#show_loading").hide();
                $.ajax({
                    url: Static.rootpay() + "/kiem-tra-dang-nhap",
                    type: 'GET',
                    data: {
                        username: _username,
                        password: _password
                    },
                    crossDomain: !0,
                    dataType: 'jsonp',
                    jsonp: !1
                })
            }
        });
        $("#namelogin, #password").onTextEnter({
            btnToTrigger: $("#btnlogin")
        })
    }
    var _showerror = function(_alert, _id) {
        if (!$("#" + _id + "_a").length) {
            $("#" + _id).attr("placeholder", _alert);
            if (_id != "") {
                $("#" + _id).css({
                    "border": "1px solid red"
                })
            }
            setTimeout(function() {
                if (_id != "") {
                    $("#" + _id).css({
                        "border": ""
                    })
                }
            }, 3000)
        }
    };
    var _logout = function() {
        $("#namelogin").val("");
        $("#password").val("");
        $.ajax({
            url: Static.rootpay() + "/danh-xuat",
            type: 'GET',
            crossDomain: !0,
            dataType: 'jsonp',
            jsonp: !1
        });
        $("#UserLogin").removeClass('hidden');
        $("#UserMenu").addClass('hidden');
        $('#searchlogout').parent().remove();
        $('#myBooking').parent().remove();
        location.reload();
    };
    var _laydangnhap = function() {
        $.ajax({
            url: Static.rootpay() + "/lay-dang-nhap",
            type: 'GET',
            crossDomain: !0,
            dataType: 'jsonp',
            jsonp: !1
        })
    }
    var _searchheader = function() {
        $('#search-header-text').keydown(function() {
            $('#linkStore').val('')
        });
        $('#header-search-button').click(function() {
            var link = $('#linkStore').val();
            if (link != null && link != '' && link != undefined) {
                window.location.href = link
            } else {
                $('#header-search-form').submit()
            }
        })
    }
    var _onpddd = function() {
        $("#show_loading").show();
        var _username = $("#namelogin").val();
        var _password = $("#password").val();
        var _k = 0;
        if (_username == "") {
            _showerror("Vui lÃ²ng nháº­p tÃªn Ä‘Äƒng nháº­p !", "namelogin");
            $("#show_loading").hide();
            _k = 1
        }
        if (_password == "") {
            _showerror("Vui lÃ²ng nháº­p máº­t kháº©u !", "password");
            $("#show_loading").hide();
            _k = 1
        }
        if (_k != 0) {
            return
        } else {
            $("#show_loading").hide();
            $.ajax({
                url: Static.rootpay() + "/kiem-tra-dang-nhap",
                type: 'GET',
                data: {
                    username: _username,
                    password: _password
                },
                crossDomain: !0,
                dataType: 'jsonp',
                jsonp: !1
            })
        }
    };
    var _getusername = function(data) {
        if (data != 0) {
            $.post(Static.rootpay() + "lay-user-name", {
                database: data
            }, function() {}).success(function(datacheck) {
                $("#show_user_name").html('<a class="dropdown-toggle menu-more" data-toggle="dropdown" href="javascript:;">' + datacheck.username + '</a>');
                if (datacheck.logintyp == 2) {
                    $("#show_user_name a").after('<ul class="dropdown-menu bullet"><li><a href="' + Static.rootpartner() + '?key=' + datacheck.fulllogin + '">My booking</a></li><li id="showbuttonloign"><a href="javascript:void(0)" onclick="Common.logout()" id="searchlogout">Logout</a></li></ul>')
                } else {
                    $("#show_user_name a").after('<ul class="dropdown-menu bullet"><li id="showbuttonloign"><a href="javascript:void(0)" onclick="Common.logout()" id="searchlogout">Logout</a></li></ul>')
                }
                setTimeout(function() {
                    $(".user-login#UserLogin").addClass('hidden');
                    $(".user-login#UserMenu").removeClass('hidden');
                }, 100);
                $(".user-name#UserName").html((datacheck.username.length > 7 ? (datacheck.username.substring(0, 7) + '..') : datacheck.username) + '<i class="fa fa-angle-down"></i>');
                $(".user-name#Name").html((datacheck.username.length > 7 ? (datacheck.username.substring(0, 7) + '..') : datacheck.username));
                if (datacheck.logintyp == 2) {
                    $(".afterLogin").after('<li><a id="myBooking" href="' + Static.rootpartner() + '?key=' + datacheck.fulllogin + ' ">My booking</a></li> <li><a href="javascript:void(0)" onclick="Common.logout()" id="searchlogout">ÄÄƒng xuáº¥t</a></li>')
                } else {
                    $(".afterLogin").after('<li><a href="javascript:void(0)" onclick="Common.logout()" id="searchlogout">ÄÄƒng xuáº¥t</a></li>')
                }
            })
        }
    };
    var handleHomePredict = function() {
        if ($('#search-predict-text').length > 0) {
            $('#search-predict-text').focusin(function() {
                var val = $("#search-predict-text").val();
                if ($(".search-suggest-predict").is(':hidden') && val.length === 0) {
                    $(".search-suggest-predict").show()
                }
                if (val.length !== 0) {
                    $(".search-suggest-predict").hide()
                }
            }).keyup(function() {
                var val = $(this).val();
                $("#search-predict-text").html(val);
                if (val.length === 0) {
                    $(".search-suggest-predict").show()
                } else {
                    $(".search-suggest-predict").hide()
                }
            });
            $(window).click(function() {
                if (!$("#search-predict-text").is(":focus")) {
                    $(".search-suggest-predict").hide()
                }
            }).keydown(function() {
                if (!$("#search-predict-text").is(":focus")) {
                    $(".search-suggest-predict").hide()
                }
            })
        }
    }
    var handleChooseHomePredict = function() {
        $('.search-suggest-predict a').click(function() {
            var text = $(this).html();
            if (text != null && text != null && text != "") {
                $('#search-predict-text').val(text)
            }
        })
    }
    var handleValidatePredict = function() {
        sweetAlertInitialize();
        $('.homewhy-item span').click(function() {
            $(this).find('.extendContent').slideToggle("fast")
        });
        $('#findDealForCustomerButton').click(function() {
            var place = '';
            if ($("#list-nameregion").length > 0) {
                place = $("#list-nameregion").text()
            } else {
                place = ""
            }
            var phone = $('#findDealForCustomerPhone').val();
            var email = $('#findDealForCustomerEmail').val();
            if (phone == '' || email == '') {
                $('.alert-danger').show();
                if (phone == '') {
                    $('.pre-phone').show();
                    $('.div-phone').addClass('has-error');
                    setTimeout(function() {
                        $('.div-phone').removeClass('has-error')
                    }, 2000)
                } else $('.pre-phone').hide();
                if (email == '') {
                    $('.pre-email').show()
                    $('.div-email').addClass('has-error');
                    setTimeout(function() {
                        $('.div-email').removeClass('has-error')
                    }, 2000)
                } else $('.pre-email').hide()
            } else {
                var fullDate = new Date()
                var twoDigitMonth = ((fullDate.getMonth().length + 1) === 1) ? (fullDate.getMonth() + 1) : '0' + (fullDate.getMonth() + 1);
                var checkin = twoDigitMonth + "/" + fullDate.getDate() + "/" + fullDate.getFullYear();
                var phone = $('#findDealForCustomerPhone').val();
                var email = $('#findDealForCustomerEmail').val();
                var typehotel = $('#typehotel').val();
                $.post(Static.rootpay() + '/gui-yeu-cau-gia-theo-vung', {
                    regioname: place,
                    checkin: checkin,
                    phone: phone,
                    email: email,
                    typehotel: typehotel
                }, function(data) {}).success(function(data) {
                    if (data.success == !0) {
                        $("#findDealForCustomerModal").modal('hide');
                        swal({
                            title: "Gá»­i yÃªu cáº§u thÃ nh cÃ´ng!",
                            text: "iVIVU.com sáº½ liÃªn há»‡ vá»›i quÃ½ khÃ¡ch trong thá»i gian sá»›m nháº¥t",
                            type: "success",
                            timer: 3000
                        })
                    } else {
                        $("#findDealForCustomerModal").modal('hide');
                        swal({
                            title: "Gá»­i yÃªu cáº§u khÃ´ng thÃ nh cÃ´ng!",
                            text: "Vui lÃ²ng thá»­ láº¡i hoáº·c liÃªn há»‡ hotline 1900 1870",
                            timer: 8000,
                            type: "error"
                        })
                    }
                })
            }
        })
    }
    var handleAutoCompletePredict = function() {
        $('#search-predict-text').focusin(function() {
            if (($(this).val() != '') && ($(this).siblings(".search-autocomplete").find('.autocomplete-wrap').html().trim() != ''))
                $(this).siblings(".search-autocomplete").show()
        }).focusout(function() {
            if (!$(this).siblings(".search-autocomplete").is(':hover'))
                $(this).siblings(".search-autocomplete").hide()
        }).on('keyup input propertychange', function() {
            var selector = $(this);
            clearTimeout($.data(this, 'timer'));
            var wait = setTimeout(function() {
                loadAutoCompletePredict(selector)
            }, 500);
            $(this).data('timer', wait)
        })
    };
    var createHotelCookie = function(name, value, days) {
        if (days) {
            var date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            var expires = "; expires=" + date.toGMTString()
        } else var expires = "";
        document.cookie = name + "=" + encodeURIComponent(value) + expires + "; path=/"
    };
    var getHotelCookie = function(name) {
        var value = "; " + document.cookie;
        var parts = value.split("; " + name + "=");
        if (parts.length == 2) return decodeURIComponent(parts.pop().split(";").shift())
    };
    var removeOneHotel = function(hoteIld) {
        var oldObjHotel = getHotelCookie('objHotel');
        if (oldObjHotel) {
            var obj;
            try {
                obj = JSON.parse(oldObjHotel)
            } catch (e) {}
            for (var i = 0; i < obj.length; i++) {
                if (obj[i].hotelId === hoteIld) {
                    obj.splice(i, 1)
                }
            }
            if (obj.length == 0) {
                Static.eraseCookie("objHotel")
            } else {
                /*createHotelCookie('objHotel', JSON.stringify(obj), 1)*/ }
        }
    }
    var isMobileX = {
        Android: function() {
            return navigator.userAgent.match(/Android/i)
        },
        BlackBerry: function() {
            return navigator.userAgent.match(/BlackBerry/i)
        },
        iOS: function() {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i)
        },
        Opera: function() {
            return navigator.userAgent.match(/Opera Mini/i)
        },
        Windows: function() {
            return navigator.userAgent.match(/IEMobile/i)
        },
        Tablet: function() {
            return (navigator.userAgent.match(/Tablet|iPad|iPod/i) && window.innerWidth <= 1280 && window.innerHeight <= 800)
        },
        any: function() {
            return (isMobileX.Android() || isMobileX.BlackBerry() || isMobileX.iOS() || isMobileX.Opera() || isMobileX.Windows() || $(window).width() <= 414)
        }
    };
    var updateHotelCookies = function() {
        if (isMobileX.any()) return;
        var hotelId = $('#hotel-id-detail').val();
        var name = $('#hotel-name-detail').text();
        var rating = $('#hotel-rating-detail').val();
        var avata = $('.htldtl-avatar').text();
        var review = $('#hotel-review-detail').val();
        var reviewCount = $('#hotel-reviewcount-detail').val();
        var reviewMessage = $('#hotel-reviewmessage-detail').val();
        var LinkFocusReview = $('#hotel-linkreview-detail').val();
        var LinkHotel = $('#hotel-linkhotel-detail').val();
        var address = $('#hotel-address-detail').val();
        var objHotel = {
            hotelId: hotelId,
            Name: name,
            Rating: rating,
            Avata: avata,
            Point: review,
            ReviewCount: reviewCount,
            ReviewMessage: reviewMessage,
            LinkHotel: LinkHotel,
            LinkFocusReview: LinkFocusReview,
            Address: address
        }
        if (objHotel.hotelId != undefined && objHotel.hotelId != "") {
            var oldObjHotel = getHotelCookie('objHotel');
            if (oldObjHotel != undefined && oldObjHotel != '') {
                var obj;
                try {
                    obj = JSON.parse(oldObjHotel)
                } catch (err) {}
                if (obj == undefined || obj.length == 0) return null;
                obj.unshift(objHotel);

                function remove_duplicates(obj) {
                    var arr = [],
                        collection = [];
                    $.each(obj, function(index, objHotel) {
                        if ($.inArray(objHotel.hotelId, arr) == -1) {
                            arr.push(objHotel.hotelId);
                            collection.push(objHotel)
                        }
                    });
                    return collection
                }
                var collection = remove_duplicates(obj);
                var removeSame = collection.slice(0, 5); /*createHotelCookie('objHotel', JSON.stringify(removeSame), 1)*/
            } else {
                var newHotel = JSON.stringify([objHotel]); /*createHotelCookie('objHotel', newHotel, 1)*/
            }
        } else return null
    };
    var readHotelCookies = function() {
        if (isMobileX.any()) return;
        var link = window.location.href;
        if (link.indexOf('khach-san') == -1) return null;
        var listHotel = getHotelCookie('objHotel');
        if (listHotel) {
            var data;
            try {
                data = JSON.parse(listHotel)
            } catch (e) {}
            if (data == undefined || data.length == 0) return null;
            $('.hotellastview').hide();
            var hotelLastView = $('.hotellastview');
            var info = '<div class="left-item col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing lastViewedHotelPanel">'
            info += '<div class="left-head col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing">KhÃ¡ch sáº¡n xem gáº§n Ä‘Ã¢y</div>'
            info += '<div class="left-content col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing">'
            info += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing vspacingtop10 lastViewedHotels">'
            if (data.length > 5) {
                var num = data.length - 1
            } else {
                var num = data.length
            }
            for (var i = 0; i < num; i++) {
                info += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing lastViewedItem">'
                info += '<div class="media">'
                info += '<span class="media-left ">'
                info += '<a href="' + data[i].LinkHotel + '"><img class="img-rounded" src="' + data[i].Avata + '"></a>'
                info += '</span>'
                info += '<div class="media-body">'
                info += '<h4>'
                info += '<a href="' + data[i].LinkHotel + '">'
                info += '' + data[i].Name + ' <i class="sprites v-icn-star-' + data[i].Rating + ' hotelItemRatingIcon"></i>'
                info += '</a>'
                info += '</h4>'
                info += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing hotelItemReviews">'
                if (data[i].Point != 0) {
                    info += '<span class="review-score"> &nbsp;' + data[i].Point + '</span>'
                    info += '<strong class="review-text"> &nbsp;' + data[i].ReviewMessage + '</strong>'
                }
                if (data[i].ReviewCount != 0) {
                    info += ' <span class="review content-horizontal"></span>'
                    info += '<a href="' + data[i].LinkFocusReview + '" class="review-count">&nbsp;' + data[i].ReviewCount + ' nháº­n xÃ©t</a>'
                }
                info += '</div>'
                info += '</div> '
                info += '</div>'
                info += '</div>'
            }
            info += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing">'
            info += '<div class="horizontalLine"></div>'
            info += '<p style="margin-left: -5px"><a href="/danh-sach-gan-day">Láº¥y giÃ¡ thÃ nh viÃªn cÃ¡c khÃ¡ch sáº¡n trÃªn <i class="glyphicon glyphicon-chevron-right"></i></a></p>'
            info += '</div>'
            info += '<div>'
            info += '<div>'
            info += '</div>'
            hotelLastView.html(info);
            hotelLastView.show();
            if (data.length > 1) {
                $('.hotelDetalList').hide();
                var hotelDetalList = $('.hotelDetalList');
                var list = '<br>'
                list += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing">'
                list += '<div class="tourPanelHeading">'
                list += ' <h4>KhÃ¡ch sáº¡n xem gáº§n Ä‘Ã¢y</h4>'
                list += '</div>'
                list += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing ">'
                list += '<div class="horizontalLine2"></div>'
                list += '</div>'
                list += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing lastViewedHotelPanel">'
                list += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing">'
                list += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing vspacingtop10 lastViewedHotels">'
                for (var i = 1; i < data.length; i++) {
                    list += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing lastViewedItem">'
                    list += '<div class="media">'
                    list += '<span class="media-left ">'
                    list += '<a href="' + data[i].LinkHotel + '"><img class="img-rounded" src="' + data[i].Avata + '"></a>'
                    list += '</span>'
                    list += '<div class="media-body">'
                    list += '<h4>'
                    list += '<a href="' + data[i].LinkHotel + '">' + data[i].Name + ' <i class="sprites v-icn-star-' + data[i].Rating + ' hotelItemRatingIcon"></i>'
                    list += '</a>'
                    list += '</h4>'
                    list += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing hotelItemReviews">'
                    if (data[i].Point != 0) {
                        list += '<span class="review-score"> &nbsp;' + data[i].Point + '</span>'
                        list += '<strong class="review-text"> &nbsp;' + data[i].ReviewMessage + '</strong>'
                    }
                    if (data[i].ReviewCount != 0) {
                        list += ' <span class="review content-horizontal"></span>'
                        list += '<a href="' + data[i].LinkFocusReview + '" class="review-count"> &nbsp;' + data[i].ReviewCount + ' nháº­n xÃ©t</a>'
                    }
                    list += '</div>'
                    list += '</div>'
                    list += '</div>'
                    list += '</div>'
                }
                list += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 vremoveSpacing">'
                list += '<div class="horizontalLine"></div>'
                list += '<p style="margin-left: -3px"><a href="/danh-sach-gan-day">Láº¥y giÃ¡ thÃ nh viÃªn cÃ¡c khÃ¡ch sáº¡n trÃªn <i class="glyphicon glyphicon-chevron-right"></i></a></p>'
                list += '</div>'
                list += '</div>'
                list += '</div>'
                list += '</div>'
                list += '</div>'
                hotelDetalList.html(list);
                hotelDetalList.show()
            }
        } else {
            return null
        }
    };
    var checkEmail = function(email) {
        var pattern = /^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;
        if (pattern.test(email)) {
            return !0
        } else {
            return !1
        }
    };
    return {
        init: function() {
            handleInit();
            handleResponsiveOnResize();
            handleIEFixes();
            handleMobiToggler();
            handleAutoComplete();
            handlePriceRequest();
            handleMap();
            handleHomePredict();
            handleChooseHomePredict();
            _login();
            _checklogin();
            _searchheader();
            EnterBeforeAutoComplete();
            handleValidatePredict();
            handleAutoCompletePredict();
            updateHotelCookies();
            readHotelCookies()
        },
        removeOneHotel: function(hotelId) {
            return removeOneHotel(hotelId)
        },
        checkEmail: function(email) {
            return checkEmail(email)
        },
        readHotelCookies: function() {
            return readHotelCookies()
        },
        getSiteName: function() {
            return siteName
        },
        getSiteLang: function() {
            return siteLanguage
        },
        reinitHandlePriceRequest: function() {
            handlePriceRequest()
        },
        logout: function() {
            _logout()
        },
        login: function() {
            _openlogin()
        },
        laydangnhap: function() {
            _laydangnhap()
        },
        enterlogin: function() {
            _onpddd()
        },
        getusername: function(data) {
            _getusername(data)
        },
        keywordEnter: function(input) {
            KeywordEnter(input)
        }
    }
}();
$(function() {
    Common.init();
    $(".score-container__inner").click(function() {
        $('html, body').animate({
            scrollTop: $("#review").offset().top
        }, 200)
    });

    if ($("#modal-fullframe").length > 0) {
        $('#modal-fullframe').on('hide.bs.modal', function(e) {
            $('body').css({
                overflow: '',
                //top: '',
                width: '',
                height: '',
                position: ''
            });
            if ($("body").attr('topcurrent')) {
                $('html, body').animate({
                    scrollTop: $("body").attr('topcurrent')
                }, 0);
                $("body").removeAttr('topcurrent');
            }
        })
    }
    $('#modal-fullsearch').on('hide.bs.modal', function(e) {
        $('body').css({
            overflow: '',
            //top: '',
            width: '',
            height: '',
            position: ''
        });
        if ($("body").attr('topcurrent')) {
            $('html, body').animate({
                scrollTop: $("body").attr('topcurrent')
            }, 0);
            $("body").removeAttr('topcurrent');
        }
        //alert($("#searchTextFullFrame").val());
        setTimeout(function() {
            $(".typeahead.tt-input").each(function() {
                $(this).val($("#searchTextFullFrame").val());
            })
        }, 500)
        document.activeElement.blur();
    })
    $("#modal-fullsearch .input-icon-close").click(function() {
        $("#searchTextFullFrame").val('');
        $("#searchTextFullFrame").focus();
    })
    $(".search-fullframe").click(function(e) {
        if (window.innerWidth < 768) {
            $("#modal-fullsearch").modal("show");
            var vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', vh + 'px');
            var scrollPosition = $(window).scrollTop();
            $("body").attr('topcurrent', scrollPosition);
            $('body').css({
                overflow: 'hidden',
                //top: '0px',
                height: '100%',
                width: '100%',
                position: 'fixed'
            });

            $('html, body').animate({
                scrollTop: $("#modal-fullsearch").offset().top
            }, 200);
            $("#searchTextFullFrame").trigger('keypress');
            setTimeout(function() {
                $("#searchTextFullFrame").val('');
                $("#searchTextFullFrame").focus();
            }, 750)
        }
    })
});
var ldnCallback = function(data) {
    if (data != 0) {
        $("#hdhdhdhhdhdhdhdhdhd").val(data);
        if (window.location.hash) {
            var hash = window.location.hash.substring(1);
            if (hash != "review") {
                window.location.hash = ''
            }
        }
    } else {
        $("#hdhdhdhhdhdhdhdhdhd").val('');
        $("#show_user_name").html('<a href="javascript:void(0)" onclick="Common.login()" data-keyboard="true" id="searchlogingg">Login</a>')
    }
    Common.getusername(data);
    if (typeof App != 'undefined') {
        if (typeof App.getPrice == 'function') {
            if (data != 0) {
                App.getPrice(data)
            } else {
                App.getPrice(data)
            }
        }
    }
    if (typeof GlobalCheckLogin == 'function') {
        GlobalCheckLogin(data)
    }
};
var ktdnCallback = function(data) {
    if (data != 0) {
        $("#login-modal").modal('hide');
        $("#hdhdhdhhdhdhdhdhdhd").val(data);
        Common.getusername(data);
        if (typeof App != 'undefined') {
            if (typeof App.getPrice == 'function') {
                if (data != 0) {
                    App.getPrice(data)
                } else {
                    App.getPrice(data)
                }
            }
        }
        $("#show_error_login").css('display', "none")
    } else {
        $("#hdhdhdhhdhdhdhdhdhd").val('');
        $("#show_error_login").html('TÃªn Ä‘Äƒng nháº­p hoáº·c máº­t kháº©u khÃ´ng Ä‘Ãºng !');
        $("#show_error_login").css('display', "block")
    }
}
$(function() {
    $.ajax({
        url: Static.rootpay() + "/lay-dang-nhap",
        type: 'GET',
        crossDomain: !0,
        dataType: 'jsonp',
        jsonp: !1
    });
    initHotline();
});

function initHotline() {
    var currentOffice = readCookie("HOTLINE");
    if (currentOffice != null && currentOffice != undefined && currentOffice.Hotline != undefined) {
        bindHeaderHotline(JSON.parse(currentOffice));
        bindFooterHotline(JSON.parse(currentOffice))
    } else {
        var isMobileX = {
            Android: function() {
                return navigator.userAgent.match(/Android/i)
            },
            BlackBerry: function() {
                return navigator.userAgent.match(/BlackBerry/i)
            },
            iOS: function() {
                return navigator.userAgent.match(/iPhone|iPad|iPod/i)
            },
            Opera: function() {
                return navigator.userAgent.match(/Opera Mini/i)
            },
            Windows: function() {
                return navigator.userAgent.match(/IEMobile/i)
            },
            Tablet: function() {
                return (navigator.userAgent.match(/Tablet|iPad|iPod/i) && window.innerWidth <= 1280 && window.innerHeight <= 800)
            },
            any: function() {
                return (isMobileX.Android() || isMobileX.BlackBerry() || isMobileX.iOS() || isMobileX.Opera() || isMobileX.Windows() || $(window).width() <= 414)
            }
        };
        var updateHotelCookies = function() {
            if (isMobileX.any()) return;
            var hotelId = $('#hotel-id-detail').val();
            var name = $('#hotel-name-detail').text();
            var rating = $('#hotel-rating-detail').val();
            var avata = $('.htldtl-avatar').text();
            var review = $('#hotel-review-detail').val();
            var reviewCount = $('#hotel-reviewcount-detail').val();
            var reviewMessage = $('#hotel-reviewmessage-detail').val();
            var LinkFocusReview = $('#hotel-linkreview-detail').val();
            var LinkHotel = $('#hotel-linkhotel-detail').val();
            var address = $('#hotel-address-detail').val();
            var objHotel = {
                hotelId: hotelId,
                Name: name,
                Rating: rating,
                Avata: avata,
                Point: review,
                ReviewCount: reviewCount,
                ReviewMessage: reviewMessage,
                LinkHotel: LinkHotel,
                LinkFocusReview: LinkFocusReview,
                Address: address
            }
            if (objHotel.hotelId != undefined && objHotel.hotelId != "") {
                var oldObjHotel = getHotelCookie('objHotel');
                if (oldObjHotel != undefined && oldObjHotel != '') {
                    var obj;
                    try {
                        obj = JSON.parse(oldObjHotel)
                    } catch (err) {}
                    if (obj == undefined || obj.length == 0) return null;
                    obj.unshift(objHotel);

                    function remove_duplicates(obj) {
                        var arr = [],
                            collection = [];
                        $.each(obj, function(index, objHotel) {
                            if ($.inArray(objHotel.hotelId, arr) == -1) {
                                arr.push(objHotel.hotelId);
                                collection.push(objHotel)
                            }
                        });
                        return collection
                    }
                    var collection = remove_duplicates(obj);
                    var removeSame = collection.slice(0, 5); /* createHotelCookie('objHotel', JSON.stringify(removeSame), 1)*/
                } else {
                    var newHotel = JSON.stringify([objHotel]); /*createHotelCookie('objHotel', newHotel, 1)*/
                }
            } else return null
        };
        $.ajax({
            url: Static.rootpay() + "get-office-code?ismobile=" + (isMobileX.any().length > 0),
            type: "POST",
            dataType: "JSON",
            contentTyp: "application/json; charset=utf-8",
            async: !1,
            crossDomain: !0,
            success: function(data) {
                createCookie("HOTLINE", JSON.stringify(data), 1 / 24);
                bindHeaderHotline(data);
                bindFooterHotline(data)
            }
        })
    }
}

function bindHeaderHotline(obj) {
    $(".hotline-link").attr("href", "tel:" + obj.Hotline);
    $(".hotline-link").html('<i class="fa fa-phone"></i> ' + obj.HotlineDisplay);
    $("#mobileDisplayName, #mobileDisplayNameFooter").html('iVIVU ' + obj.Code);
    $("#MobileTime, #MobileTimeFooter").html('<i class="fa fa-clock-o"></i> ' + (obj.Time != null ? obj.Time : "7h30 â†’ 21h"));
    $("#DeskTime, #DeskTimeFooter").html('<i class="fa fa-clock-o"></i> ' + (obj.Time != null ? obj.Time : "7h30 â†’ 21h"));
    $("#DeskDisplayName, #DeskDisplayNameFooter").html(obj.locationName);
    $("#hotelinefs").html("");
    $("#hotelinefs").html(obj.HotlineDisplay);
    $(".hotelListCustomerServicePhone").html(obj.HotlineDisplay);
    $(".combo__btn-call").attr("href", "tel:" + obj.Hotline);
    $(".combo__btn-call1").attr("href", "tel:" + obj.Hotline);
    $(".combo__btn-call").html('<i class="fa fa-phone"></i>' + obj.HotlineDisplay);
    $(".combo__btn-call1").html('<i class="fa fa-phone"></i>' + obj.HotlineDisplay);
    $(".bind-list-hotel-hotline").attr("href", "tel:" + obj.Hotline);
    $(".bind-list-hotel-hotline").html('<span class="display-text">' + obj.HotlineDisplay + '</span>');
    $("#404").html(obj.HotlineDisplay)
}

function bindFooterHotline(obj) {
    $(".bind-hotline-bt").attr("href", "tel:" + obj.Hotline);
    $(".bind-hotline-bt").text(obj.HotlineDisplay)
}

function CreateDefaultLocation() {
    setTimeout(function() {
        var obj = JSON.parse(readCookie("HOTLINE"));
        if (obj != null) {
            if (obj.Code == "HCM") {
                $('.location-hcm').addClass('active');
                $('.location-hn').removeClass('active');
                $('.location-ct').removeClass('active');
                $('.location-dn').removeClass('active')
            } else if (obj.Code == "HN") {
                $('.location-hcm').removeClass('active');
                $('.location-hn').addClass('active');
                $('.location-ct').removeClass('active');
                $('.location-dn').removeClass('active')
            } else if (obj.Code == "CT") {
                $('.location-hcm').removeClass('active');
                $('.location-hn').removeClass('active');
                $('.location-ct').addClass('active');
                $('.location-dn').removeClass('active')
            } else if (obj.Code == "DN") {
                $('.location-hcm').removeClass('active');
                $('.location-hn').removeClass('active');
                $('.location-ct').removeClass('active');
                $('.location-dn').addClass('active')
            }
        }
    }, 500)
}

function createCookie(name, value, days, domain) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        var expires = '; expires=' + date.toGMTString()
    } else {
        expires = ''
    }
    var domainTemp = '';
    if (domain) {
        domainTemp = ';domain=' + domain;
    }
    document.cookie = name + '=' + encodeURIComponent(value) + expires + '; path=/' + domainTemp;
}

function readCookie(name) {
    var nameEQ = name + '=';
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = decodeURIComponent(ca[i]);
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length)
    }
    return null
}

function HeaderHotline(obj) {
    if (obj == "SG") {
        writeHotline("SG")
    } else if (obj == "HN") {
        writeHotline("HN")
    } else if (obj == "DN") {
        writeHotline("DN")
    } else {
        writeHotline("CT")
    }
    CreateDefaultLocation()
}

function writeHotline(Name) {
    $.ajax({
        url: Static.rootpay() + "/ip-mapping",
        type: "POST",
        dataType: "JSON",
        contentTyp: "application/json; charset=utf-8",
        async: !1,
        crossDomain: !0,
        data: {
            locationName: Name
        },
        success: function(data) {
            if (data.error == undefined) {
                createCookie("HOTLINE", JSON.stringify(data), 1 / 24);
                bindHeaderHotline(data);
                bindFooterHotline(data)
            }
        },
        error: function() {}
    })
}

function sleep(milliseconds) {
    var start = new Date().getTime();
    for (var i = 0; i < 1e7; i++) {
        if ((new Date().getTime() - start) > milliseconds) {
            break
        }
    }
}
var vh = window.innerHeight * 0.01;
// Then set the custom --vh value to the root of the document
document.documentElement.style.setProperty('--vh', vh + 'px');
window.addEventListener('resize', function() {
    // Update the element's size
    var vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', vh + 'px');

});

function fixView(el) {
    var viewportHeight = window.innerHeight;
    $(el).css({
        height: viewportHeight
    });
}

function handleLogging(name, content, status) {
    var objRequest = {
        content: content,
        name: name,
        type: "client",
        status: status != undefined ? status : ""
    };
    var settings = {
        "async": !0,
        "crossDomain": !0,
        "url": "http://localhost:34290/api/erp/Logging/write-json",
        "method": "POST",
        "headers": {
            "Content-Type": "application/json"
        },
        "processData": !1,
        "data": JSON.stringify(objRequest)
    }
    $.ajax(settings).done(function(response) {})
}
var holidaydata = [];

function holidaycal() {
    var settings = {
        "async": !0,
        "crossDomain": !0,
        "url": Static.rootGate() + "api/Data/calendarholidays",
        "method": "GET",
        "headers": {
            "Content-Type": "application/json"
        },
        "processData": !1
    }
    if (!readCookie('flagCalendarholidays')) {
        $.ajax(settings).done(function(response) {
            if (response) {
                window.localStorage.setItem('calendarholidays', JSON.stringify(response));
                createCookie("flagCalendarholidays", true);
                holidaydata = response;
                var style = document.createElement('style');
                for (var i = 0; i < response.length; i++) {
                    //style.innerHTML += ".holiday_" + response[i].id + "{border-radius: 50% !important;position: relative; border: solid 0.5px #e52822 !important; color: #e52822 !important;} .holiday_" + response[i].id + ":after{ position: absolute;font-size: 10px;left: 50%;bottom: -18px;transform: translate(-50%, -50%); color: #e52822;opacity: 1;line-height: normal;font-weight: normal; content: '" + response[i].name + "'; } ";
                    style.innerHTML += ".holiday_" + response[i].id + "{position: relative;color: #e52822 !important;} .holiday_" + response[i].id + ":before{content: ''; border-radius: 50%; position: absolute; top: 0; bottom: 0; left: 0; right: 0; height: 100%; border: solid 0.5px #e52822;} .holiday_" + response[i].id + ":after{ position: absolute;font-size: 10px;left: 50%;bottom: -18px;transform: translate(-50%, -50%); color: #e52822;opacity: 1;line-height: normal;font-weight: normal; content: '" + response[i].name + "'; } ";

                }
                document.head.appendChild(style);
            }
        })
    } else {
        var valueStorage = window.localStorage.getItem('calendarholidays');
        if (valueStorage != undefined && valueStorage != null && valueStorage != '') {
            var data = JSON.parse(valueStorage);
            holidaydata = data;
            var style = document.createElement('style');
            for (var i = 0; i < data.length; i++) {
                //style.innerHTML += ".holiday_" + data[i].id + "{border-radius: 50% !important;position: relative; border: solid 0.5px #e52822 !important; color: #e52822 !important;} .holiday_" + data[i].id + ":after{ position: absolute;font-size: 10px;left: 50%;bottom: -18px;transform: translate(-50%, -50%); color: #e52822;opacity: 1;line-height: normal;font-weight: normal; content: '" + data[i].name + "'; } ";
                style.innerHTML += ".holiday_" + data[i].id + "{position: relative;color: #e52822 !important;}  .holiday_" + data[i].id + ":before{content: ''; border-radius: 50%; position: absolute; top: 0; bottom: 0; left: 0; right: 0; height: 100%; border: solid 0.5px #e52822;} .holiday_" + data[i].id + ":after{ position: absolute;font-size: 10px;left: 50%;bottom: -18px;transform: translate(-50%, -50%); color: #e52822;opacity: 1;line-height: normal;font-weight: normal; content: '" + data[i].name + "'; } ";
            }
            document.head.appendChild(style);
        }
    }
}
holidaycal();

function convertTodateHoliday(dateStr, dateType) {
    var returnName = undefined;
    index = holidaydata.findIndex(x => x.date === dateStr && x.isNameDisplay == 1);
    if (index != -1) {
        returnName = holidaydata[index].name;
        setTimeout(function() {
            //$('p.hightlight-holiday').removeClass('hightlight-holiday');
            $("." + dateType + " p[class='v_field__description']").text(returnName);
            var elHasText = $("." + dateType + " p[class='v_field__description']:contains('" + returnName + "')");
            if (elHasText.length > 0) {
                elHasText.addClass('hightlight-holiday')
            }
        }, 0);
        return returnName;
    } else {
        index = holidaydata.findIndex(x => x.date === dateStr);
        if (index != -1) {
            returnName = moment(dateStr).format('dddd');
            setTimeout(function() {
                var elHasText = $("p[class='v_field__description']:contains('" + returnName + "')");
                if (elHasText.length > 0) {
                    elHasText.addClass('hightlight-holiday');
                }
            }, 0);
            return returnName;
        }
    }
}

$(".htdt-container").on("click", ".btn-change-location", function() {
    if ($(this).hasClass("location-hcm")) {
        writeHotline("SG")
    } else if ($(this).hasClass("location-hn")) {
        writeHotline("HN")
    } else if ($(this).hasClass("location-ct")) {
        writeHotline("CT")
    } else if ($(this).hasClass("location-dn")) {
        writeHotline("DN")
    }
    CreateDefaultLocation()
})
window.addEventListener('popstate', function() {
    location.reload(true);
});
document.addEventListener("DOMContentLoaded", function() {
    if (navigator.browserVersion <= 10 && navigator.browserName == "Safari") {
        return !1
    } else {
        var lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));
        var active = !1;
        if ("IntersectionObserver" in window) {
            var lazyImageObserver = new IntersectionObserver(function(entries, observer) {
                entries.forEach(function(entry) {
                    if (entry.isIntersecting) {
                        var lazyImage = entry.target;
                        lazyImage.src = lazyImage.dataset.src;
                        lazyImage.srcset = lazyImage.dataset.srcset;
                        lazyImage.classList.remove("lazy");
                        lazyImageObserver.unobserve(lazyImage)
                    }
                })
            });
            lazyImages.forEach(function(lazyImage) {
                lazyImageObserver.observe(lazyImage)
            })
        } else {}
        const lazyLoad = function() {
            if (active === !1) {
                active = !0;
                setTimeout(function() {
                    lazyImages.forEach(function(lazyImage) {
                        if ((lazyImage.getBoundingClientRect().top <= window.innerHeight && lazyImage.getBoundingClientRect().bottom >= 0) && getComputedStyle(lazyImage).display !== "none") {
                            lazyImage.src = lazyImage.dataset.src;
                            lazyImage.srcset = lazyImage.dataset.srcset;
                            lazyImage.classList.remove("lazy");
                            lazyImages = lazyImages.filter(function(image) {
                                return image !== lazyImage
                            });
                            if (lazyImages.length === 0) {
                                document.removeEventListener("scroll", lazyLoad);
                                window.removeEventListener("resize", lazyLoad);
                                window.removeEventListener("orientationchange", lazyLoad)
                            }
                        }
                    });
                    active = !1
                }, 200)
            }
        };
        document.addEventListener("scroll", lazyLoad);
        window.addEventListener("resize", lazyLoad);
        window.addEventListener("orientationchange", lazyLoad)
    }
})
1